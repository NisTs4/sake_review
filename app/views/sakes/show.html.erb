<div class="panel panel-default">
  <div class="panel-body">
    <div class="row">

      <div class="col-md-4">
	<%= image_tag @sake.image.url(:medium) %>

	<div class="star-rating" data-score= <%= @avg_review %>></div>
	<em><%= "#{@reviews.length} reviews" %></em>

	<div class="table-responsive">
	  <table class="table">
	    <tbody>
	      <tr>
		<td><strong>Name:</strong></td>
		<td><%= @sake.name %></td>
	      </tr>
	      <tr>
		<td><strong>Description:</strong></td>
		<td><%= @sake.description %></td>
	      </tr>
	      <tr>
		<td><strong>Size:</strong></td>
		<td><%= @sake.size %></td>
	      </tr>
	      <tr>
		<td><strong>Maker:</strong></td>
		<td><%= @sake.maker %></td>
	      </tr>
	      <tr>
		<td><strong>Rating:</strong></td>
		<td><%= @sake.rating %></td>
	      </tr>
	    </tbody>
	  </table>
	  <%= link_to "Write a Review", new_sake_review_path(@sake) %>
	</div>
      </div>

      <div class="col-md-7 col-md-offset-1">
	<h1 class="review_title"><%= @sake.name %></h1>
	<p><%= @sake.description %></p>

	<% if @reviews.blank? %>
	  <h3>No review just yet, would you like to add the first!</h3>
	  <%= link_to "Write Review", new_sake_review_path(@sake), class: "btn btn-danger" %>
	<% else %>
	  <% @reviews.each do |review| %>
	    <div class="reviews">
	      <div class="star-rating" data-score= <%= review.rating %> ></div>
	      <p><%= review.comment %></p>
	    </div>
	  <% end %>
	<% end %>
      </div>

    </div>
  </div>
</div>

<%= link_to 'Edit', edit_sake_path(@sake) %> |
<%= link_to 'Back', sakes_path %>

<script>
  $('.star-rating').raty({
    path: '/assets',
    readOnly: true,
    score: function() {
      return $(this).attr('data-score');
    }
  });
</script>
